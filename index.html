<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Ping Rewards ·Äû·Ää·Ä∫ Watch video , Complete social tasks , Earn points , Get rewards , Cash out platform ·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫·Åã">
    <meta name="keywords"
        content="Ping Rewards, Money Making, Earn Money, Watch Videos, Social Tasks, Points, Rewards, Cash Out, Online Earning, Video Rewards, Task Completion, Referral Program">
    <meta property="og:description"
        content="Ping Rewards ·Äû·Ää·Ä∫ video ·ÄÄ·Äº·Ää·Ä∑·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏·Äî·Äæ·ÄÑ·Ä∑·Ä∫ social tasks ·Äï·Äº·ÄØ·Äú·ÄØ·Äï·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏·Ä°·Ä¨·Ä∏·Äñ·Äº·ÄÑ·Ä∑·Ä∫ ·Ä°·ÄΩ·Äî·Ä∫·Äú·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏·Äê·ÄΩ·ÄÑ·Ä∫·Äï·Ä≠·ÄØ·ÄÄ·Ä∫·ÄÜ·Ä∂·Äõ·Äæ·Ä¨·Äñ·ÄΩ·Ä±·Äõ·Äî·Ä∫·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ platform ·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·Äñ·Äº·ÄÖ·Ä∫·Äû·Ää·Ä∫·Åã">
    <title>Ping Rewards</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%236366f1' d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9v-4h2.5c1.38 0 2.5-1.12 2.5-2.5S12.88 7 11.5 7H9v-2h2.5C14.43 5 16 6.57 16 8.5S14.43 12 11.5 12H9v4h4v-2z'/%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#6366f1',
                        'secondary': '#f9a8d4',
                        'background': '#0f172a',
                        'card-bg': '#1e293b',
                        'text-color': '#e2e8f0',
                        'muted-text': '#94a3b8',
                        'accent-green': '#10b981',
                        'accent-orange': '#f59e0b',
                        'accent-purple': '#a855f7',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    keyframes: {
                        spin: {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' },
                        },
                        coinFly: {
                            '0%': { transform: 'translateY(0) scale(1)', opacity: '1' },
                            '100%': { transform: 'translateY(-100px) scale(0.5)', opacity: '0' },
                        }
                    },
                    animation: {
                        spin: 'spin 1s linear infinite',
                        coin: 'coinFly 1s ease-in-out forwards',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            margin: 0;
            overflow-x: hidden;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .backdrop.open {
            display: block;
        }

        .no-scroll {
            overflow: hidden;
        }

        .coin-icon {
            animation: coinFly 1s ease-in-out forwards;
        }

        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.7);
        }

        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .animate-scroll {
            animation: scroll 12s linear infinite;
        }

        .animate-scroll:hover {
            animation-play-state: paused;
        }

        .circular-progress-container {
            position: fixed;
            bottom: 80px;
            right: 20px;
            z-index: 1001;
            width: 70px;
            height: 70px;
            background-color: #1e293b;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            display: none;
        }

        .circular-progress {
            position: relative;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(#F59E0B 0deg, #334155 0deg);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .circular-progress::before {
            content: "";
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #1e293b;
        }

        .progress-value {
            position: relative;
            font-size: 0.9rem;
            font-weight: bold;
            color: #F59E0B;
        }

        #app-content {
            overflow-y: auto;
            height: 100vh;
        }
    </style>
</head>

<body class="bg-background text-text-color">

    <!-- Loading Overlay -->
    <div id="loading-overlay"
        class="fixed inset-0 bg-background bg-opacity-70 flex justify-center items-center z-[1002] transition-opacity duration-300 opacity-0 pointer-events-none">
        <div class="animate-spin rounded-full h-12 w-12 border-4 border-text-color border-t-primary"></div>
    </div>

    <!-- Main Application Container -->
    <div id="app-container" class="view flex flex-col md:flex-row w-full min-h-screen" style="display: flex;">
        <!-- Sidebar -->
        <div id="sidebar"
            class="sidebar fixed md:relative z-[100] md:z-0 top-0 left-0 w-64 h-full bg-card-bg shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out md:translate-x-0">
            <div class="p-6 pb-4 border-b border-slate-700 flex items-center">
                <svg class="w-10 h-10 fill-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9v-4h2.5c1.38 0 2.5-1.12 2.5-2.5S12.88 7 11.5 7H9v-2h2.5C14.43 5 16 6.57 16 8.5S14.43 12 11.5 12H9v4h4v-2z" />
                </svg>
                <span class="text-xl font-bold ml-2">Ping Rewards</span>
            </div>
            <ul class="flex flex-col p-4 space-y-2">
                <li>
                    <a href="#"
                        class="nav-link user-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200"
                        data-target="user-dashboard-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M3 13h11v-2H3v2zm0 4h11v-2H3v4zm0-8h11V7H3v2zm13 .01V7h5v2.01h-5zM16 17h5v-2h-5v2zm0-4h5v-2h-5v2z" />
                        </svg>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="nav-link user-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200"
                        data-target="watch-videos-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
                        </svg>
                        Watch Videos
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="nav-link user-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200"
                        data-target="social-tasks-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6z" />
                        </svg>
                        Social Tasks
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="nav-link user-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200"
                        data-target="points-history-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                        </svg>
                        Points History
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="nav-link user-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200"
                        data-target="invite-and-earn-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                        </svg>
                        Invite & Earn
                    </a>
                </li>
                <li>
                    <a href="#"
                        class="nav-link user-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200"
                        data-target="about-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 14h-2v-2h2v2zm0-4h-2V7h2v5z" />
                        </svg>
                        About
                    </a>
                </li>
                <li style="padding:1rem 0;border-bottom:1px solid #334155;"></li>
                <li>
                    <a href="https://t.me/Mr_PingGP" target="_blank"
                        style="display:flex;align-items:center;text-decoration:none;color:#ff69b4;padding:0.75rem;">
                        <svg style="width:24px;height:24px;margin-right:12px;fill:currentColor;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 14h-2v-2h2v2zm0-4h-2V7h2v5z" />
                        </svg>
                        Help
                    </a>
                </li>

                <!-- Admin Links (Hidden by default) -->
                <hr class="my-4 border-slate-700 admin-link" style="display: none;">
                <li class="admin-link" style="display: none;">
                    <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200" data-target="admin-dashboard-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M3 13h11v-2H3v2zm0 4h11v-2H3v4zm0-8h11V7H3v2zm13 .01V7h5v2.01h-5zM16 17h5v-2h-5v2zm0-4h5v-2h-5v2z" />
                        </svg>
                        Admin Dashboard
                    </a>
                </li>
                <li class="admin-link" style="display: none;">
                    <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200" data-target="manage-videos-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
                        </svg>
                        Manage Videos
                    </a>
                </li>
                <li class="admin-link" style="display: none;">
                    <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200" data-target="manage-social-tasks-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 10V8h4v4h3l-5 5-5-5h3z" />
                        </svg>
                        Manage Social Tasks
                    </a>
                </li>
                <li class="admin-link" style="display: none;">
                    <a href="#" class="nav-link flex items-center p-3 rounded-lg hover:bg-primary/20 transition-colors duration-200" data-target="manage-users-view">
                        <svg class="w-6 h-6 mr-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                        </svg>
                        Manage Users
                    </a>
                </li>
            </ul>
            <div id="sidebar-profile" class="p-6 border-t border-slate-700 mt-auto"></div>
        </div>

        <div id="backdrop" class="backdrop fixed inset-0 bg-black bg-opacity-50 z-[99] hidden md:hidden"></div>

        <!-- Main Content Area -->
        <div id="app-content" class="flex-grow p-4 md:p-6 transition-all duration-300 ease-in-out">
            <header class="flex justify-between items-center mb-6">
                <h1 class="text-2xl md:text-3xl font-bold flex items-center">
                    <button id="menu-toggle"
                        class="md:hidden p-2 -ml-2 mr-2 rounded-md bg-slate-700 text-white hover:bg-slate-600 transition-colors duration-200">
                        <svg class="w-8 h-8 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
                        </svg>
                    </button>
                    <span id="page-title">Dashboard</span>
                </h1>
                <div id="header-meta" class="hidden md:flex items-center space-x-4"></div>
            </header>

            <!-- User Dashboard View -->
            <div id="user-dashboard-view" class="content-view" style="display: none;">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                    <div class="card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 col-span-1 lg:col-span-3 flex flex-col md:flex-row justify-between items-center">
                        <div class="w-full max-w-7xl overflow-hidden bg-yellow-400 border-y-0 border-yellow-600 py-0 shadow-2xl rounded-4">
                            <div class="flex animate-scroll min-w-max">
                                <span class="text-sm sm:text-sm font-extrabold text-gray-900 uppercase tracking-wide whitespace-nowrap px-0">
                                    üéâ ·Ä°·Äõ·Ä±·Ä∏·ÄÄ·Äº·ÄÆ·Ä∏·Äû·Ää·Ä∫ About ·ÄÄ·Ä≠·ÄØ ·Äî·Ä≠·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏ ·ÄÖ·Ää·Ä∫·Ä∏·ÄÄ·Äô·Ä∫·Ä∏·ÄÅ·Äª·ÄÄ·Ä∫·ÄÄ·Ä≠·ÄØ ·Ä°·Äõ·ÄÑ·Ä∫·Äñ·Äê·Ä∫·Äï·Ä±·Ä∏·Äï·Ä´ üéâ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </span>
                                <span class="text-sm sm:text-sm font-extrabold text-gray-900 uppercase tracking-wide whitespace-nowrap px-0">
                                    üéâ Important: Please click 'About' and read the rules first. üéâ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </span>
                            </div>
                        </div>
                        <div>
                            <h2 id="welcome-message" class="text-xl font-semibold mb-2"></h2>
                            <p class="text-muted-text">Ready to earn more points? Let's start watching some videos.</p>
                        </div>
                        <a href="#" class="nav-link user-link mt-4 md:mt-0 px-6 py-3 bg-primary hover:bg-indigo-600 text-white font-semibold rounded-lg transition-colors duration-300 whitespace-nowrap" data-target="watch-videos-view">
                            Watch Now
                        </a>
                    </div>
                    <div class="card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                        <h2 class="text-lg font-semibold mb-2 text-muted-text">Total Points</h2>
                        <div class="text-4xl font-bold text-primary" id="total-points-value">0</div>
                    </div>
                    <div class="card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                        <h2 class="text-lg font-semibold mb-2 text-muted-text">Estimated Earnings</h2>
                        <div class="text-4xl font-bold text-accent-green" id="estimated-earnings-value">$0.00</div>
                    </div>
                    <div class="card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                        <h2 class="text-lg font-semibold mb-2 text-muted-text">Videos Watched</h2>
                        <div class="text-4xl font-bold text-accent-purple" id="videos-watched-value">0</div>
                    </div>
                </div>

                <!-- Leaderboard Section -->
                <div class="mt-6">
                    <h2 class="text-xl font-semibold mb-4">üèÜ Top Earners</h2>
                    <div id="leaderboard-container" class="space-y-3">
                        <div class="text-center text-muted-text p-4">
                            <div id="leaderboard-list" class="space-y-2"></div>
                        </div>
                    </div>
                </div>

                <div class="quick-actions mb-6">
                    <h2 class="text-xl font-semibold mb-4">Quick Actions</h2>
                    <div class="flex flex-wrap gap-4">
                        <a href="#" class="nav-link user-link px-6 py-3 bg-card-bg border border-slate-700 rounded-lg text-text-color hover:bg-slate-700 transition-colors duration-200" data-target="watch-videos-view">Watch Videos</a>
                        <a href="#" class="nav-link user-link px-6 py-3 bg-card-bg border border-slate-700 rounded-lg text-text-color hover:bg-slate-700 transition-colors duration-200" data-target="points-history-view">View History</a>
                        <a href="#" class="nav-link user-link px-6 py-3 bg-card-bg border border-slate-700 rounded-lg text-text-color hover:bg-slate-700 transition-colors duration-200" data-target="social-tasks-view">Complete Tasks</a>
                    </div>
                </div>

                <div class="card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 flex flex-col md:flex-row justify-between items-center">
                    <div>
                        <h2 class="text-xl font-semibold mb-2">Cash Out Points</h2>
                        <p class="text-muted-text">10000 Points = $1.00</p>
                        <p class="text-muted-text">Keep watching to increase your earnings.</p>
                    </div>
                    <button class="cashout-btn mt-4 md:mt-0 px-6 py-3 bg-primary text-white font-semibold rounded-lg transition-colors duration-300 whitespace-nowrap" id="cashout-button">Cash Out</button>
                </div>
            </div>

            <!-- Watch Videos View -->
            <div id="watch-videos-view" class="content-view" style="display: none;">
                <div class="flex flex-col sm:flex-row gap-4 mb-6">
                    <input type="text" id="search-bar"
                        class="flex-grow px-4 py-2 rounded-full bg-card-bg border border-slate-700 focus:outline-none focus:ring-2 focus:ring-primary placeholder-muted-text"
                        placeholder="Search videos...">
                    <div class="flex overflow-x-auto pb-2 gap-2 w-full sm:w-auto sm:justify-end no-scrollbar" style="-webkit-overflow-scrolling: touch;">
                        <button class="filter-btn active px-4 py-2 rounded-full border border-primary bg-primary text-white text-sm hover:bg-primary/80 transition-all duration-300 whitespace-nowrap flex-shrink-0" data-category="all">All</button>
                        <button class="filter-btn px-4 py-2 rounded-full border border-slate-700 bg-card-bg text-sm hover:bg-slate-700 transition-all duration-300 whitespace-nowrap flex-shrink-0" data-category="Nature">Nature</button>
                        <button class="filter-btn px-4 py-2 rounded-full border border-slate-700 bg-card-bg text-sm hover:bg-slate-700 transition-all duration-300 whitespace-nowrap flex-shrink-0" data-category="Education">Education</button>
                        <button class="filter-btn px-4 py-2 rounded-full border border-slate-700 bg-card-bg text-sm hover:bg-slate-700 transition-all duration-300 whitespace-nowrap flex-shrink-0" data-category="Travel">Travel</button>
                        <button class="filter-btn px-4 py-2 rounded-full border border-slate-700 bg-card-bg text-sm hover:bg-slate-700 transition-all duration-300 whitespace-nowrap flex-shrink-0" data-category="Food">Food</button>
                        <button class="filter-btn px-4 py-2 rounded-full border border-slate-700 bg-card-bg text-sm hover:bg-slate-700 transition-all duration-300 whitespace-nowrap flex-shrink-0" data-category="Gaming">Gaming</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-4 gap-y-8" id="video-grid"></div>
            </div>

            <!-- Video Player View -->
            <div id="video-player-view" class="content-view" style="display: none;">
                <button id="video-player-back-btn" class="mb-4 flex items-center gap-2 px-4 py-2 bg-primary hover:bg-indigo-600 rounded-lg text-white font-semibold transition-colors duration-200">
                    <svg class="w-5 h-5 fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
                    </svg>
                    Back to Videos
                </button>

                <div id="circular-points-tracker" class="circular-progress-container">
                    <div id="progress-circle" class="circular-progress">
                        <span id="progress-value-text" class="progress-value">+0</span>
                    </div>
                </div>

                <div class="bg-card-bg p-0 rounded-xl shadow-md border border-slate-700">
                    <div class="aspect-video w-full rounded-xl overflow-hidden mb-4">
                        <div id="video-iframe" class="w-full h-full bg-black"></div>
                    </div>
                    <h2 class="text-2xl font-semibold mb-1 p-4" id="video-player-title"></h2>
                    <p class="text-muted-text mb-4 px-4" id="video-player-description"></p>
                </div>
            </div>

            <!-- Social Tasks View -->
            <div id="social-tasks-view" class="content-view" style="display: none;">
                <h2 class="text-xl font-semibold mb-4">Complete Social Tasks</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="social-tasks-grid">
                    <div class="col-span-full text-center text-muted-text p-6">Loading tasks...</div>
                </div>
            </div>

            <!-- Points History View -->
            <div id="points-history-view" class="content-view" style="display: none;">
                <div class="bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                    <h2 class="text-xl font-semibold mb-4">Points History</h2>
                    <p class="text-muted-text mb-6">A record of all the points you have earned.</p>
                    <div class="overflow-x-auto rounded-lg">
                        <table class="w-full text-left table-auto">
                            <thead class="bg-slate-700 text-slate-400 uppercase text-xs">
                                <tr>
                                    <th class="p-4 rounded-tl-lg">Date</th>
                                    <th class="p-4">Description</th>
                                    <th class="p-4 rounded-tr-lg">Points</th>
                                </tr>
                            </thead>
                            <tbody id="points-history-table" class="divide-y divide-slate-700"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ‚úÖ FIXED: Invite & Earn View with Stats -->
            <div id="invite-and-earn-view" class="content-view" style="display: none;">
                <div class="bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 mb-6">
                    <h2 class="text-xl font-semibold mb-4 text-primary">·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·Äï·Äº·ÄÆ·Ä∏ ·Ä°·Äô·Äæ·Äê·Ä∫·Äô·Äª·Ä¨·Ä∏·Äõ·Äö·Ä∞·Äï·Ä´ (Invite & Earn)</h2>
                    <p class="text-muted-text mb-6">·Äû·ÄÑ·Ä∫·Åè ·ÄÄ·Ä≠·ÄØ·Äö·Ä∫·Äï·Ä≠·ÄØ·ÄÑ·Ä∫·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·ÄÄ·ÄØ·Äí·Ä∫ (Referral Code) ·ÄÄ·Ä≠·ÄØ ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Åç ·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·Äï·Ä´·Åã ·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äê·ÄÖ·Ä∫·Ä¶·Ä∏ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äñ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äê·Ä≠·ÄØ·ÄÑ·Ä∫·Ä∏ ·Ä°·Äô·Äæ·Äê·Ä∫ <strong class="text-accent-green">100</strong> ·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫·Åã</p>

                    <!-- ‚úÖ NEW: Referral Stats Cards -->
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-slate-700/50 p-4 rounded-lg text-center">
                            <div class="text-3xl font-bold text-primary" id="total-referrals-count">0</div>
                            <div class="text-sm text-muted-text">·Äñ·Ä≠·Äê·Ä∫·Äë·Ä¨·Ä∏·Äû·Ä∞·Ä°·Äõ·Ä±·Ä°·Äê·ÄΩ·ÄÄ·Ä∫</div>
                        </div>
                        <div class="bg-slate-700/50 p-4 rounded-lg text-center">
                            <div class="text-3xl font-bold text-accent-green" id="total-referral-bonus">0</div>
                            <div class="text-sm text-muted-text">·Äõ·Äõ·Äæ·Ä≠·Äë·Ä¨·Ä∏·Äû·Ä±·Ä¨ Bonus Points</div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·ÄÄ·ÄØ·Äí·Ä∫ (Your Referral Code)</label>
                            <div class="flex">
                                <input type="text" id="referral-code-input" value="Loading..." readonly
                                    class="flex-grow px-4 py-3 rounded-l-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary text-text-color font-mono tracking-wider">
                                <button id="copy-referral-btn" class="px-4 py-3 bg-accent-green hover:bg-emerald-600 rounded-r-lg text-white font-semibold transition-colors duration-200 flex items-center gap-2">
                                    <svg class="w-5 h-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" />
                                    </svg>
                                    Copy
                                </button>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-2">·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·Äú·ÄÑ·Ä∑·Ä∫ (Your Referral Link)</label>
                            <div class="flex">
                                <input type="text" id="referral-link-input" value="Loading..." readonly
                                    class="flex-grow px-4 py-3 rounded-l-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary text-text-color text-sm">
                                <button id="copy-link-btn" class="px-4 py-3 bg-accent-green hover:bg-emerald-600 rounded-r-lg text-white font-semibold transition-colors duration-200 flex items-center gap-2">
                                    <svg class="w-5 h-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" />
                                    </svg>
                                    Copy
                                </button>
                            </div>
                        </div>

                        <div class="pt-4">
                            <h3 class="text-lg font-semibold mb-2">·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·Äô·Äæ·ÄØ ·Äô·Äæ·Äê·Ä∫·Äê·Äô·Ä∫·Ä∏ (Invite History)</h3>
                            <div class="bg-slate-700/50 p-4 rounded-lg overflow-x-auto">
                                <table class="w-full text-left table-auto">
                                    <thead class="text-slate-400 uppercase text-xs">
                                        <tr>
                                            <th class="p-2">·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äû·Ä∞</th>
                                            <th class="p-2">·Äõ·Äõ·Äæ·Ä≠·ÄÅ·Ä≤·Ä∑·Äû·Ää·Ä∑·Ä∫ ·Ä°·Äô·Äæ·Äê·Ä∫</th>
                                        </tr>
                                    </thead>
                                    <tbody id="invited-users-table">
                                        <tr>
                                            <td colspan="2" class="p-2 text-center text-muted-text">·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´·Åã</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- About View -->
            <div id="about-view" class="content-view" style="display: none;">
                <div class="bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                    <h2 class="text-2xl font-bold mb-4 text-primary">Ping Rewards ·Ä°·ÄÄ·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏</h2>
                    <p class="text-muted-text mb-6">Ping Rewards ·ÄÄ·Ä≠·ÄØ ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äï·Äº·ÄÆ·Ä∏ ·Äó·ÄÆ·Äí·ÄÆ·Äö·Ä≠·ÄØ·ÄÄ·Äº·Ää·Ä∑·Ä∫·Äõ·ÄÑ·Ä∫·Ä∏·Åä Task ·Äô·Äª·Ä¨·Ä∏·Äú·ÄØ·Äï·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äõ·ÄÑ·Ä∫·Ä∏ ·Ä°·Äô·Äæ·Äê·Ä∫·Äô·Äª·Ä¨·Ä∏·ÄÖ·ÄØ·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÄ·Ä¨ ·ÄÑ·ÄΩ·Ä±·Äû·Ä¨·Ä∏·Ä°·Äñ·Äº·ÄÖ·Ä∫ ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã</p>
                    <div class="space-y-6 text-text-color">
                        <section>
                            <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                <span class="bg-primary/20 text-primary px-2 py-1 rounded">·ÅÅ</span> ·Ä°·Äô·Äæ·Äê·Ä∫·Äõ·Äö·Ä∞·Äî·Ää·Ä∫·Ä∏·Äú·Äô·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏
                            </h3>
                            <ul class="list-disc list-inside mt-2 space-y-2 ml-4 text-sm md:text-base">
                                <li><span class="font-semibold text-accent-orange">Watch Videos:</span> ·Äó·ÄÆ·Äí·ÄÆ·Äö·Ä≠·ÄØ·ÄÄ·Äº·Ää·Ä∑·Ä∫·Äõ·Äæ·ÄØ·Äï·Ä´ (·ÅÅ·ÅÄ ·ÄÖ·ÄÄ·Äπ·ÄÄ·Äî·Ä∑·Ä∫·Äú·Äª·Äæ·ÄÑ·Ä∫ ·ÅÅ ·Äô·Äæ·Äê·Ä∫ ·Äõ·Äõ·Äæ·Ä≠·Äï·Ä´·Äô·Ää·Ä∫)·Åã</li>
                                <li><span class="font-semibold text-accent-green">Social Tasks:</span> Facebook, Telegram, YouTube ·ÄÖ·Äû·Ää·Ä∫·Äê·Ä≠·ÄØ·Ä∑·ÄÄ·Ä≠·ÄØ Follow/Join ·Äú·ÄØ·Äï·Ä∫·Äï·Äº·ÄÆ·Ä∏ ·Ä°·Äô·Äæ·Äê·Ä∫·Äô·Äª·Ä¨·Ä∏·Äõ·Äö·Ä∞·Äï·Ä´·Åã</li>
                                <li><span class="font-semibold text-primary">Invite & Earn:</span> ·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·ÄÄ·Ä≠·ÄØ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·Äï·Äº·ÄÆ·Ä∏ ·Äê·ÄÖ·Ä∫·Ä¶·Ä∏·Äú·Äª·Äæ·ÄÑ·Ä∫ ·ÅÅ·ÅÄ·ÅÄ ·Äô·Äæ·Äê·Ä∫ ·Äõ·Äö·Ä∞·Äï·Ä´·Åã</li>
                            </ul>
                        </section>
                        <section>
                            <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                <span class="bg-primary/20 text-primary px-2 py-1 rounded">·ÅÇ</span> ·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ (Cash Out)
                            </h3>
                            <ul class="list-disc list-inside mt-2 space-y-2 ml-4 text-sm md:text-base">
                                <li>·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Ä°·Äô·Äæ·Äê·Ä∫ <span class="text-white font-bold">10000 Points</span> ·Äï·Äº·Ää·Ä∑·Ä∫·Äï·Ä´·ÄÄ ·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã</li>
                                <li>10000 Points ·Äú·Äª·Äæ·ÄÑ·Ä∫ <span class="text-white font-bold">$1.00</span> ·Äî·Äæ·ÄÑ·Ä∑·Ä∫ ·Ää·ÄÆ·Äô·Äª·Äæ·Äï·Ä´·Äû·Ää·Ä∫·Åã</li>
                                <li>KBZ Pay, Wave Pay ·Äî·Äæ·ÄÑ·Ä∑·Ä∫ Binance (USDT) ·Äê·Ä≠·ÄØ·Ä∑·Äñ·Äº·ÄÑ·Ä∑·Ä∫ ·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã</li>
                                <li>·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äï·Äº·ÄÆ·Ä∏ <span class="text-accent-orange font-semibold">·ÅÇ·ÅÑ ·Äî·Ä¨·Äõ·ÄÆ·Äô·Äæ ·ÅÑ·Åà ·Äî·Ä¨·Äõ·ÄÆ·Ä°·Äê·ÄΩ·ÄÑ·Ä∫·Ä∏</span> ·Äú·Ä∞·ÄÄ·Äº·ÄÆ·Ä∏·Äô·ÄÑ·Ä∫·Ä∏·Äê·Ä≠·ÄØ·Ä∑·Äë·Ä∂ ·Äï·Ä±·Ä∏·Äï·Ä≠·ÄØ·Ä∑·Äï·Ä±·Ä∏·Äû·ÄΩ·Ä¨·Ä∏·Äô·Ää·Ä∫·Äñ·Äº·ÄÖ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã</li>
                            </ul>
                        </section>
                        <section class="bg-red-500/10 p-4 rounded-lg border border-red-500/30">
                            <h3 class="text-lg font-bold text-red-400 flex items-center gap-2">‚ö†Ô∏è ·Äê·ÄÑ·Ä∫·Ä∏·ÄÄ·Äº·Äï·Ä∫·Äû·Ä±·Ä¨ ·ÄÖ·Ää·Ä∫·Ä∏·ÄÄ·Äô·Ä∫·Ä∏·ÄÅ·Äª·ÄÄ·Ä∫·Äô·Äª·Ä¨·Ä∏</h3>
                            <ul class="list-disc list-inside mt-2 space-y-2 ml-4 text-xs md:text-sm text-red-200">
                                <li>·Äê·ÄÖ·Ä∫·Ä¶·Ä∏·Äú·Äª·Äæ·ÄÑ·Ä∫ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·Äû·Ä¨ ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äõ·Äï·Ä´·Äô·Ää·Ä∫·Åã</li>
                                <li>VPN ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏·ÄÄ·Ä≠·ÄØ ·Äú·ÄØ·Ä∂·Ä∏·Äù (·Äú·ÄØ·Ä∂·Ä∏·Äù) ·ÄÅ·ÄΩ·ÄÑ·Ä∑·Ä∫·Äô·Äï·Äº·ÄØ·Äï·Ä´·Åã</li>
                                <li>·Äó·ÄÆ·Äí·ÄÆ·Äö·Ä≠·ÄØ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ Fake View (Bot) ·Äô·Äª·Ä¨·Ä∏·Äñ·Äº·ÄÑ·Ä∑·Ä∫ ·ÄÄ·Äº·Ää·Ä∑·Ä∫·Äõ·Äæ·ÄØ·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ ·Äê·ÄΩ·Ä±·Ä∑·Äõ·Äæ·Ä≠·Äï·Ä´·ÄÄ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äï·Ä≠·Äê·Ä∫·Äû·Ä≠·Äô·Ä∫·Ä∏·Äï·Ä´·Äô·Ää·Ä∫·Åã</li>
                                <li>Social Task ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Ä°·Äô·Äæ·Äî·Ä∫·Äê·ÄÄ·Äö·Ä∫ ·Äú·ÄØ·Äï·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äõ·Äï·Ä´·Äô·Ää·Ä∫ (Check ·Äï·Äº·Äî·Ä∫·Äú·ÄØ·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫)·Åã</li>
                                <li>·ÄÖ·Ää·Ä∫·Ä∏·ÄÄ·Äô·Ä∫·Ä∏·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äñ·Äª·ÄÄ·Ä∫·Äë·Ä¨·Ä∏·Äû·Ä±·Ä¨ ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äô·Äª·Ä¨·Ä∏·Åè ·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ·Äô·Äª·Ä¨·Ä∏·ÄÄ·Ä≠·ÄØ ·Äï·Äö·Ä∫·Äñ·Äª·ÄÄ·Ä∫·Äû·ÄΩ·Ä¨·Ä∏·Äï·Ä´·Äô·Ää·Ä∫·Åã</li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>

            <!-- Admin Dashboard View -->
            <div id="admin-dashboard-view" class="content-view" style="display: none;">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6" id="admin-dashboard-grid">
                    <div class="stat-card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 flex items-center">
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center mr-4">
                            <svg class="w-6 h-6 fill-primary" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                            </svg>
                        </div>
                        <div class="flex-grow">
                            <h3 class="text-lg font-semibold text-muted-text">Total Users</h3>
                            <div class="text-3xl font-bold" id="admin-total-users-value">0</div>
                        </div>
                    </div>
                    <div class="stat-card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 flex items-center">
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-accent-purple/20 flex items-center justify-center mr-4">
                            <svg class="w-6 h-6 fill-accent-purple" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
                            </svg>
                        </div>
                        <div class="flex-grow">
                            <h3 class="text-lg font-semibold text-muted-text">Total Videos</h3>
                            <div class="text-3xl font-bold" id="admin-total-videos-value">0</div>
                        </div>
                    </div>
                    <div class="stat-card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 flex items-center">
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-accent-green/20 flex items-center justify-center mr-4">
                            <svg class="w-6 h-6 fill-accent-green" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2z" />
                            </svg>
                        </div>
                        <div class="flex-grow">
                            <h3 class="text-lg font-semibold text-muted-text">Total Points</h3>
                            <div class="text-3xl font-bold" id="admin-total-points-earned-value">0</div>
                        </div>
                    </div>
                    <div class="stat-card bg-card-bg p-6 rounded-xl shadow-md border border-slate-700 flex items-center">
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-accent-orange/20 flex items-center justify-center mr-4">
                            <svg class="w-6 h-6 fill-accent-orange" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2z" />
                            </svg>
                        </div>
                        <div class="flex-grow">
                            <h3 class="text-lg font-semibold text-muted-text">Total Payouts</h3>
                            <div class="text-3xl font-bold" id="admin-total-payouts-value">$0</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Manage Videos View -->
            <div id="manage-videos-view" class="content-view" style="display: none;">
                <div class="bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                        <h2 class="text-xl font-semibold whitespace-nowrap">Manage Videos</h2>
                        <input type="text" id="manage-videos-search" class="flex-grow max-w-md px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary placeholder-muted-text" placeholder="Search videos...">
                        <button id="add-video-btn" class="px-4 py-2 bg-primary hover:bg-indigo-600 rounded-lg text-white font-semibold transition-colors duration-200 whitespace-nowrap">Add New Video</button>
                    </div>
                    <div class="overflow-x-auto rounded-lg">
                        <table class="w-full text-left table-auto">
                            <thead class="bg-slate-700 text-slate-400 uppercase text-xs">
                                <tr>
                                    <th class="p-4 rounded-tl-lg">Title</th>
                                    <th class="p-4">Category</th>
                                    <th class="p-4">Points</th>
                                    <th class="p-4 rounded-tr-lg">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="videos-table" class="divide-y divide-slate-700"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Manage Social Tasks View -->
            <div id="manage-social-tasks-view" class="content-view" style="display: none;">
                <div class="bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                        <h2 class="text-xl font-semibold whitespace-nowrap">Manage Social Tasks</h2>
                        <input type="text" id="manage-social-tasks-search" class="flex-grow max-w-md px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary placeholder-muted-text" placeholder="Search tasks...">
                        <button id="add-social-task-btn" class="px-4 py-2 bg-primary hover:bg-indigo-600 rounded-lg text-white font-semibold transition-colors duration-200 whitespace-nowrap">Add New Task</button>
                    </div>
                    <div class="overflow-x-auto rounded-lg">
                        <table class="w-full text-left table-auto">
                            <thead class="bg-slate-700 text-slate-400 uppercase text-xs">
                                <tr>
                                    <th class="p-4 rounded-tl-lg">Task Title</th>
                                    <th class="p-4">Platform</th>
                                    <th class="p-4">Link</th>
                                    <th class="p-4">Points</th>
                                    <th class="p-4 rounded-tr-lg">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="social-tasks-table" class="divide-y divide-slate-700"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Manage Users View -->
            <div id="manage-users-view" class="content-view" style="display: none;">
                <div class="bg-card-bg p-6 rounded-xl shadow-md border border-slate-700">
                    <h2 class="text-xl font-semibold mb-2">Manage Users</h2>
                    <input type="text" id="manage-users-search" class="w-full px-4 py-2 mb-4 rounded-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary placeholder-muted-text" placeholder="Search users...">
                    <p class="text-muted-text mb-6">View user data, manage status, and edit information.</p>
                    <div class="overflow-x-auto rounded-lg">
                        <table class="w-full text-left table-auto">
                            <thead class="bg-slate-700 text-slate-400 uppercase text-xs">
                                <tr>
                                    <th class="p-4 rounded-tl-lg">User ID</th>
                                    <th class="p-4">Name</th>
                                    <th class="p-4">Phone</th>
                                    <th class="p-4">Payment</th>
                                    <th class="p-4">Points</th>
                                    <th class="p-4 rounded-tr-lg">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body" class="divide-y divide-slate-700"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cashout Modal -->
    <div id="cashout-modal" class="modal-overlay fixed inset-0 flex justify-center items-center z-[1000] hidden">
        <div class="modal-content bg-card-bg p-8 rounded-xl w-11/12 max-w-lg shadow-2xl border border-slate-700">
            <h3 class="text-xl font-semibold mb-4">Cash Out Request</h3>
            <form id="cashout-form" class="space-y-4">
                <div>
                    <label for="payment-method" class="block text-sm font-medium mb-1">Payment Method</label>
                    <select id="payment-method" name="paymentMethod" required class="w-full px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="KBZ Pay">KBZ Pay</option>
                        <option value="Wave Pay">Wave Pay</option>
                        <option value="Binance (USDT)">Binance (USDT)</option>
                    </select>
                </div>
                <div>
                    <label for="payout-amount" class="block text-sm font-medium mb-1">Amount ($)</label>
                    <input type="text" id="payout-amount" name="payoutAmount" readonly class="w-full px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary">
                </div>
                <div>
                    <label for="payout-phone" class="block text-sm font-medium mb-1">Phone / Wallet Address</label>
                    <input type="text" id="payout-phone" name="payoutPhone" required class="w-full px-4 py-2 rounded-lg bg-slate-700 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Enter your phone or wallet address">
                </div>
                <div class="flex justify-end gap-2 pt-4">
                    <button type="button" id="cashout-cancel-btn" class="px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-lg text-white font-semibold transition-colors duration-200">Cancel</button>
                    <button type="submit" id="cashout-submit-btn" class="px-4 py-2 bg-primary hover:bg-indigo-600 rounded-lg text-white font-semibold transition-colors duration-200">Submit Request</button>
                </div>
            </form>
        </div>
    </div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const user = tg.initDataUnsafe.user;
        const startParam = tg.initDataUnsafe.start_param || null;
        const userId = user ? user.id : "1856743644";

        const backendUrl = "https://pingrewards.mroocodes.workers.dev";

        let cachedVideos = [];
        let player;
        let isVideoPlaying = false;
        let videoTimerInterval;
        let secondsCount = 0;
        let sessionPoints = 0;

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('data-target');
                    if (targetId) {
                        showView(targetId);
                        if (window.innerWidth < 768) {
                            document.getElementById('sidebar').classList.remove('open');
                            document.getElementById('backdrop').classList.remove('open');
                        }
                    }
                });
            });

            document.getElementById('cashout-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const method = document.getElementById('payment-method').value;
                const amount = document.getElementById('payout-amount').value;
                const phone = document.getElementById('payout-phone').value;
                const submitBtn = document.getElementById('cashout-submit-btn');

                submitBtn.innerText = "Processing...";
                submitBtn.disabled = true;

                try {
                    const res = await fetch(`${backendUrl}/api/cashout`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ userId, amount, method, phone })
                    });

                    if (res.ok) {
                        alert("·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äö·Ä∞·Äô·Äæ·ÄØ ·Äê·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·Ä≠·ÄØ·ÄÅ·Äª·ÄÄ·Ä∫ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã ·ÅÑ·Åà ·Äî·Ä¨·Äõ·ÄÆ·Ä°·Äê·ÄΩ·ÄÑ·Ä∫·Ä∏ ·ÄÖ·ÄÖ·Ä∫·ÄÜ·Ä±·Ä∏·Äï·Ä±·Ä∏·Äï·Ä´·Äô·Ää·Ä∫·Åã");
                        document.getElementById('cashout-modal').classList.add('hidden');
                        initApp();
                    } else {
                        alert("·Ä°·Äô·Äæ·Ä¨·Ä∏·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ ·Äñ·Äº·ÄÖ·Ä∫·Äû·ÄΩ·Ä¨·Ä∏·Äï·Ä´·Äû·Ää·Ä∫·Åã ·Äî·Ä±·Ä¨·ÄÄ·Ä∫·Äô·Äæ ·Äë·Äï·Ä∫·ÄÖ·Äô·Ä∫·Ä∏·ÄÄ·Äº·Ää·Ä∑·Ä∫·Äï·Ä´·Åã");
                    }
                } catch (err) {
                    console.error(err);
                    alert("·ÄÅ·Äª·Ä≠·Äê·Ä∫·ÄÜ·ÄÄ·Ä∫·Äô·Äæ·ÄØ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫·Åã");
                } finally {
                    submitBtn.innerText = "Submit Request";
                    submitBtn.disabled = false;
                }
            });

            document.getElementById('cashout-button').addEventListener('click', () => {
                const pts = parseInt(document.getElementById('total-points-value').innerText);
                if (pts < 10000) {
                    alert("·ÄÑ·ÄΩ·Ä±·Äë·ÄØ·Äê·Ä∫·Äõ·Äî·Ä∫ ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·ÅÅ·ÅÄ,·ÅÄ·ÅÄ·ÅÄ ·Äô·Äæ·Äê·Ä∫ ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã");
                } else {
                    document.getElementById('payout-amount').value = (pts / 10000).toFixed(2);
                    document.getElementById('cashout-modal').classList.remove('hidden');
                }
            });

            document.getElementById('cashout-cancel-btn').addEventListener('click', () => {
                document.getElementById('cashout-modal').classList.add('hidden');
            });

            document.getElementById('menu-toggle').addEventListener('click', () => {
                document.getElementById('sidebar').classList.add('open');
                document.getElementById('backdrop').classList.add('open');
            });

            document.getElementById('backdrop').addEventListener('click', () => {
                document.getElementById('sidebar').classList.remove('open');
                document.getElementById('backdrop').classList.remove('open');
            });

            document.getElementById('video-player-back-btn').addEventListener('click', () => {
                stopPointTimer();
                if (player) player.stopVideo();
                showView('watch-videos-view');
            });

            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => {
                        b.classList.remove('bg-primary', 'text-white', 'border-primary');
                        b.classList.add('bg-card-bg', 'text-sm', 'border-slate-700');
                    });
                    btn.classList.remove('bg-card-bg', 'text-sm', 'border-slate-700');
                    btn.classList.add('bg-primary', 'text-white', 'border-primary');
                    loadVideos(btn.getAttribute('data-category'));
                });
            });

            setupCopyButtons();
            initApp();
        });

        function showView(viewId) {
            const currentPlayerView = document.getElementById('video-player-view');
            if (currentPlayerView && currentPlayerView.style.display === 'block' && viewId !== 'video-player-view') {
                stopPointTimer();
                if (player && player.stopVideo) player.stopVideo();
                tg.BackButton.hide();
            }

            document.querySelectorAll('.content-view').forEach(v => v.style.display = 'none');
            const target = document.getElementById(viewId);
            if (target) {
                target.style.display = 'block';
                document.getElementById('page-title').innerText = viewId.replace(/-/g, ' ').replace('view', '').toUpperCase();

                if (viewId === 'user-dashboard-view') {
                    const pts = parseInt(document.getElementById('total-points-value').innerText) || 0;
                    document.getElementById('estimated-earnings-value').textContent = `$${(pts / 10000).toFixed(2)}`;
                }
                if (viewId === 'admin-dashboard-view') fetchAdminDashboardData();
                if (viewId === 'manage-videos-view') renderManageVideosTable();
                if (viewId === 'manage-users-view') fetchAllUsers();
                if (viewId === 'manage-social-tasks-view') renderManageSocialTasksTable();
                // ‚úÖ NEW: Load referral stats when viewing Invite & Earn
                if (viewId === 'invite-and-earn-view') loadReferralStats();
            }
        }

        async function initApp() {
            try {
                const userName = user ? user.first_name : "Guest User";
                const userRes = await fetch(`${backendUrl}/api/get-user?id=${userId}&name=${userName}&ref=${startParam}`);
                const userData = await userRes.json();

                if (userData && !userData.error) {
                    document.getElementById('total-points-value').textContent = userData.points || 0;
                    document.getElementById('welcome-message').textContent = `Welcome, ${userData.name || 'User'}!`;

                    document.getElementById('referral-code-input').value = userId;
                    document.getElementById('referral-link-input').value = `https://t.me/PingRewords_bot?start=${userId}`;

                    const adminIds = ["1856743644"];
                    if (adminIds.includes(String(userId))) {
                        document.querySelectorAll('.admin-link').forEach(el => el.style.display = 'block');
                    }

                    loadVideos();
                    loadTasks();
                    loadHistory();
                    loadReferralHistory();
                    loadLeaderboard();
                    updateWatchCount();
                    loadReferralStats(); // ‚úÖ NEW

                    showView('user-dashboard-view');
                }
            } catch (err) {
                console.error("App Init Error:", err);
            }
        }

        // ‚úÖ NEW: Load Referral Stats
        async function loadReferralStats() {
            try {
                const res = await fetch(`${backendUrl}/api/get-referral-stats?id=${userId}`);
                const stats = await res.json();
                
                document.getElementById('total-referrals-count').textContent = stats.totalReferrals || 0;
                document.getElementById('total-referral-bonus').textContent = stats.totalBonus || 0;
            } catch (e) {
                console.error("Error loading referral stats:", e);
            }
        }

        async function loadVideos(categoryFilter = 'all') {
            try {
                if (cachedVideos.length === 0) {
                    const res = await fetch(`${backendUrl}/api/get-videos`);
                    cachedVideos = await res.json();
                }

                const historyRes = await fetch(`${backendUrl}/api/get-watch-history?userId=${userId}`);
                const history = await historyRes.json();
                const watchedTitles = history.map(h => h.description.replace('Watched: ', ''));

                const grid = document.getElementById('video-grid');
                let displayVideos = categoryFilter === 'all' ? [...cachedVideos] : cachedVideos.filter(v => v.category === categoryFilter);

                displayVideos.sort((a, b) => {
                    const aWatched = watchedTitles.includes(a.title);
                    const bWatched = watchedTitles.includes(b.title);
                    return aWatched - bWatched;
                });

                if (displayVideos.length === 0) {
                    grid.innerHTML = '<p class="text-muted-text col-span-full text-center">No videos found.</p>';
                    return;
                }

                grid.innerHTML = displayVideos.map(v => {
                    const isOnCooldown = watchedTitles.includes(v.title);
                    const cardClass = isOnCooldown ? "opacity-50 grayscale pointer-events-none" : "hover:border-primary cursor-pointer";
                    const badge = isOnCooldown ? `<span class="absolute top-2 right-2 bg-red-600 text-white text-[10px] px-2 py-1 rounded">48h Cooldown</span>` : "";

                    return `
                        <div class="video-card relative bg-card-bg p-4 rounded-xl border border-slate-700 transition ${cardClass}" 
                             onclick="${isOnCooldown ? '' : `playVideo('${v.id}', '${v.video_url}', '${v.title}')`}">
                            ${badge}
                            <img src="https://img.youtube.com/vi/${getYouTubeId(v.video_url)}/hqdefault.jpg" class="w-full rounded-lg mb-2">
                            <h3 class="font-semibold text-sm line-clamp-2 text-white">${v.title}</h3>
                            <p class="text-xs text-muted-text mt-1">${v.category} ‚Ä¢ ${isOnCooldown ? 'Locked' : 'Available'}</p>
                        </div>
                    `;
                }).join('');
            } catch (e) { console.error(e); }
        }

        async function loadTasks() {
            try {
                const [resTasks, resCompleted] = await Promise.all([
                    fetch(`${backendUrl}/api/get-tasks`),
                    fetch(`${backendUrl}/api/get-completed-tasks?userId=${userId}`)
                ]);
                const tasks = await resTasks.json();
                const completedIds = await resCompleted.json();
                const grid = document.getElementById('social-tasks-grid');

                grid.innerHTML = tasks.map(t => {
                    const isCompleted = completedIds.map(id => String(id)).includes(String(t.id));
                    const btnClass = isCompleted ? "bg-slate-600 cursor-not-allowed" : "bg-primary hover:bg-indigo-600";
                    const btnText = isCompleted ? "Completed ‚úÖ" : "Complete Task";
                    const btnAction = isCompleted ? "" : `onclick="completeTask('${t.id}', ${t.points}, '${t.title}', '${t.link}', this)"`;

                    return `
                        <div class="card bg-card-bg p-6 rounded-xl border border-slate-700 text-center">
                            <h3 class="text-lg font-bold text-white">${t.title}</h3>
                            <p class="text-accent-green font-bold my-2">+${t.points} PTS</p>
                            <button ${btnAction} class="inline-block px-6 py-2 rounded-lg font-bold transition text-white ${btnClass}">
                                ${btnText}
                            </button>
                        </div>`;
                }).join('');
            } catch (e) { console.error(e); }
        }

        async function completeTask(taskId, points, title, link, btn) {
            window.open(link, '_blank');

            const originalText = btn.innerText;
            btn.innerText = "Checking...";
            btn.style.pointerEvents = "none";
            btn.classList.remove("bg-primary");
            btn.classList.add("bg-slate-500");

            setTimeout(async () => {
                try {
                    const res = await fetch(`${backendUrl}/api/complete-social-task`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ userId, taskId, title })
                    });
                    const result = await res.json();

                    if (result.success) {
                        alert(`Success! Task Completed. +${result.earned} points.`);
                        btn.innerText = "Completed ‚úÖ";
                        btn.className = "inline-block px-6 py-2 rounded-lg font-bold transition text-white bg-slate-600 cursor-not-allowed";

                        const el = document.getElementById('total-points-value');
                        el.innerText = parseInt(el.innerText) + result.earned;
                        loadHistory();
                    } else {
                        alert(result.message || "Something went wrong!");
                        btn.innerText = originalText;
                        btn.style.pointerEvents = "auto";
                        btn.classList.add("bg-primary");
                        btn.classList.remove("bg-slate-500");
                    }
                } catch (e) {
                    console.error(e);
                    btn.innerText = originalText;
                    btn.style.pointerEvents = "auto";
                }
            }, 5000);
        }

        async function loadHistory() {
            try {
                const res = await fetch(`${backendUrl}/api/get-history?id=${userId}`);
                const history = await res.json();
                const table = document.getElementById('points-history-table');
                table.innerHTML = history.map(h => `
                    <tr class="border-b border-slate-700">
                        <td class="p-4 text-xs text-muted-text">${new Date(h.created_at).toLocaleDateString()}</td>
                        <td class="p-4 text-sm text-white">${h.description}</td>
                        <td class="p-4 font-bold ${h.points >= 0 ? 'text-accent-green' : 'text-red-400'}">${h.points >= 0 ? '+' : ''}${h.points}</td>
                    </tr>
                `).join('');
            } catch (e) { console.error(e); }
        }

        async function loadReferralHistory() {
            try {
                const res = await fetch(`${backendUrl}/api/get-referrals?id=${userId}`);
                const referrals = await res.json();
                const table = document.getElementById('invited-users-table');
                if (referrals.length === 0) {
                    table.innerHTML = `<tr><td colspan="2" class="p-2 text-center text-muted-text">·Äû·Ä∞·ÄÑ·Äö·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äô·Äª·Ä¨·Ä∏ ·Äñ·Ä≠·Äê·Ä∫·ÄÅ·Ä±·Ä´·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´·Åã</td></tr>`;
                    return;
                }

                table.innerHTML = referrals.map(u => `
                    <tr class="border-b border-slate-700">
                        <td class="p-2 text-sm text-white font-semibold">${u.name}</td>
                        <td class="p-2 font-bold text-accent-green">+100</td>
                    </tr>
                `).join('');
            } catch (e) { console.error(e); }
        }

        async function loadLeaderboard() {
            try {
                const res = await fetch(`${backendUrl}/api/get-leaderboard`);
                const topUsers = await res.json();
                const list = document.getElementById('leaderboard-list');
                const medals = ['ü•á', 'ü•à', 'ü•â', '4Ô∏è‚É£', '5Ô∏è‚É£'];
                list.innerHTML = topUsers.map((u, i) => `
                    <div class="flex justify-between items-center bg-slate-800 p-3 rounded-lg border border-slate-700">
                        <span class="font-bold text-white">${medals[i]} ${u.name}</span>
                        <span class="text-accent-green font-bold">${u.points} PTS</span>
                    </div>
                `).join('');
            } catch (e) { console.error(e); }
        }

        function getYouTubeId(url) {
            const match = url.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);
            return (match && match[2].length == 11) ? match[2] : null;
        }

        window.playVideo = function (id, url, title) {
            const videoId = getYouTubeId(url);
            document.getElementById('video-player-title').textContent = title;

            tg.BackButton.show();
            tg.onEvent('backButtonClicked', () => { showView('watch-videos-view'); });

            showView('video-player-view');
            if (player && player.loadVideoById) {
                player.loadVideoById(videoId);
            } else {
                player = new YT.Player('video-iframe', {
                    height: '100%', width: '100%', videoId: videoId,
                    playerVars: { 'autoplay': 1, 'playsinline': 1 },
                    events: { 'onStateChange': onPlayerStateChange }
                });
            }
            startPointTimer();
        }

        function onPlayerStateChange(event) {
            isVideoPlaying = (event.data === YT.PlayerState.PLAYING);
            if (event.data === YT.PlayerState.ENDED) {
                stopPointTimer();
                showView('watch-videos-view');
            }
        }

        function startPointTimer() {
            if (videoTimerInterval) clearInterval(videoTimerInterval);
            const container = document.getElementById('circular-points-tracker');
            const text = document.getElementById('progress-value-text');
            const circle = document.getElementById('progress-circle');
            container.style.display = 'flex';
            secondsCount = 0; sessionPoints = 0;
            videoTimerInterval = setInterval(() => {
                if (!isVideoPlaying) return;
                secondsCount++;
                let degrees = (secondsCount % 10) * 36;
                circle.style.background = `conic-gradient(#F59E0B ${degrees || 360}deg, #334155 0deg)`;
                if (secondsCount % 10 === 0) {
                    sessionPoints++;
                    text.innerText = `+${sessionPoints}`;
                    const el = document.getElementById('total-points-value');
                    const newPts = parseInt(el.innerText) + 1;
                    el.innerText = newPts;
                    document.getElementById('estimated-earnings-value').textContent = `$${(newPts / 10000).toFixed(2)}`;
                }
            }, 1000);
        }

        async function stopPointTimer() {
            if (videoTimerInterval) { clearInterval(videoTimerInterval); videoTimerInterval = null; }
            document.getElementById('circular-points-tracker').style.display = 'none';

            if (sessionPoints > 0) {
                const videoTitle = document.getElementById('video-player-title').textContent;
                const earned = sessionPoints; sessionPoints = 0;
                await fetch(`${backendUrl}/api/award-points`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId, amount: earned, desc: `Watched: ${videoTitle}` })
                });
                loadHistory();
                updateWatchCount();
                setTimeout(() => loadVideos(), 1000);
            }
        }

        async function updateWatchCount() {
            try {
                const res = await fetch(`${backendUrl}/api/get-history?id=${userId}`);
                const history = await res.json();
                const watchCount = history.filter(h => h.description && h.description.includes('Watched:')).length;
                document.getElementById('videos-watched-value').innerText = watchCount;
            } catch (e) {
                console.error("Error updating watch count:", e);
            }
        }

        function setupCopyButtons() {
            document.getElementById('copy-referral-btn').onclick = () => {
                navigator.clipboard.writeText(document.getElementById('referral-code-input').value);
                alert("Copied!");
            };
            document.getElementById('copy-link-btn').onclick = () => {
                navigator.clipboard.writeText(document.getElementById('referral-link-input').value);
                alert("Copied!");
            };
        }

        async function fetchAdminDashboardData() {
            try {
                const res = await fetch(`${backendUrl}/api/get-admin-stats`);
                const stats = await res.json();
                document.getElementById('admin-total-users-value').innerText = stats.totalUsers || 0;
                document.getElementById('admin-total-videos-value').innerText = stats.totalVideos || 0;
                document.getElementById('admin-total-points-earned-value').innerText = stats.totalPoints || 0;
                document.getElementById('admin-total-payouts-value').innerText = `$${stats.totalPayouts || 0}`;
            } catch (e) { console.error(e); }
        }

        async function fetchAllUsers() {
            try {
                const res = await fetch(`${backendUrl}/api/admin/users`);
                const users = await res.json();
                const tbody = document.getElementById('users-table-body');
                tbody.innerHTML = users.map(u => `
                    <tr class="border-b border-slate-700">
                        <td class="p-4 text-sm">${u.user_id}</td>
                        <td class="p-4 text-sm">${u.name}</td>
                        <td class="p-4 text-sm">${u.phone || '-'}</td>
                        <td class="p-4 text-sm">${u.payment || '-'}</td>
                        <td class="p-4 text-sm font-bold text-accent-green">${u.points}</td>
                        <td class="p-4"><button class="text-primary hover:underline">Edit</button></td>
                    </tr>
                `).join('');
            } catch (e) { console.error(e); }
        }

        async function renderManageVideosTable() { /* Placeholder for admin */ }
        async function renderManageSocialTasksTable() { /* Placeholder for admin */ }
    </script>
</body>
</html>
